mysql让存储结果分页，用于复杂查询。

似乎讨论分页的人非常少，难道大家都沉迷于limit m,n? 在有索引的情况下，limit m,n速度足够，可是在复杂条件搜索时， where somthing order by somefield+somefield mysql会搜遍数据库，找出“所有”符合条件的记录，然后取出m,n条记录。 如果你的数据量有几十万条，用户又搜索一些非常通俗的词， 然后要依次读最后几页重温旧梦。。。

mysql该非常悲壮的不停操作硬盘。 所以，能试着让mysql也存储分页，当然要程式配合。（这里只是提出一个设想，欢迎大家一起讨论）

asp的分页：在asp系统中有recordset对象来实现分页，不过大量数据放在内存中，而且不知道什么时候才失效(请asp高手指点). sql数据库分页：用存储过程+游标方式分页，具体实现原理不是非常清晰，设想如果用一次查询就得到需要的结果，或是id集，需要后续页时只要按照结果中的ids读出相关记录。这样只要非常小的空间保留本次查询的所有ids. (sql中的查询结果不知道怎样清晰过期垃圾?) 这样，能让mysql模拟存储分页机制：

1. select id from $table where $condition order by $field limit $max_pages*$count; 查询符合条件的ids. 限定最大符合条件的记录数量，也能不加。

2. 因为php在执行结束后所有变量都要lost，所以能考虑: 方案a. 在mysql建立临时表，查询结果用一个时间或随机数作为唯一标志插入。 其中建立page1~pagen个字段，每个字段保存该页中需要的ids, 这样一个id对一条记录. 方案b. 如果打开session,也能放在session中保存，实际上是放在文件中保存。 建立一个$ids数组，$ids[1]~$ids[$max_pages]. 考虑到有时候用户会开几个 窗口同时查询，要为$ids做一个唯一标志，避免查询结果相互覆盖。二维数组 和$$var都是好办法。

3. 在每页页的请求中，直接找到对应的ids，中间以”,”间隔： select * from $table where id in ($ids); 速度绝对快

4. 收尾要考虑查询结果的自动清晰，能设置定时或按比例随机清晰。如果用mysql临时表要加上一个时间标志字段，session中要加入$ids["time"]=time(); 在一定时间以后不操作视为过期数据。

5. 如果要优化，能考虑用把1和2.a中的语句合并成select …… into ….
